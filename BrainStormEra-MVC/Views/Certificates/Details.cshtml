@model BrainStormEra_MVC.Models.ViewModels.CertificateDetailsViewModel
@{
    ViewData["Title"] = "Certificate Details";
    Layout = null;
    var printMode = !string.IsNullOrEmpty(Context.Request.Query["print"]);
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"] - BrainStormEra</title>
    <meta name="description" content="Certificate of completion for @Model.CourseName">
    <link rel="icon" type="image/x-icon" href="~/img/logo/logowithoutbackground.png" sizes="48x48">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="~/css/global.css">
    @if (!printMode)
    {
        <link rel="stylesheet" href="~/css/layouts/base.css">
        <link rel="stylesheet" href="~/css/components/header.css">
        <link rel="stylesheet" href="~/css/components/footer.css">
        <link rel="stylesheet" href="~/css/components/loader.css">
    }
    <link rel="stylesheet" href="~/css/pages/certificate-details.css">
    <link rel="stylesheet" href="~/css/components/toast-notifications.css">

    <!-- Print styles -->
    <style>
        @@media print {
            .no-print,
            .page-loader,
            header,
            footer,
            .breadcrumb,
            .action-buttons {
                display: none !important;
            }

            .certificate-container {
                margin: 0 !important;
                padding: 0 !important;
                box-shadow: none !important;
            }

            .certificate-content {
                page-break-inside: avoid;
            }

            body {
                background: white !important;
            }
        }
    </style>
</head>

<body class="@(printMode ? "print-mode" : "")">
    @if (!printMode)
    {
        <!-- Display toast notifications from TempData -->
        @if (TempData["SuccessMessage"] != null)
        {
            <div data-toast-success="@TempData["SuccessMessage"]" style="display:none;"></div>
        }
        @if (TempData["ErrorMessage"] != null)
        {
            <div data-toast-error="@TempData["ErrorMessage"]" style="display:none;"></div>
        }

        <!-- Page Loader -->
        <div class="page-loader">
            <div class="loader"></div>
        </div>

        <!-- Header -->
        @await Html.PartialAsync("~/Views/Shared/Header/_Header.cshtml")
    }

    <!-- Certificate Content -->
    <div class="certificate-page">
        <div class="container">
            @if (!printMode)
            {
                <!-- Breadcrumb and Actions -->
                <div class="page-header no-print">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="@Url.Action("Index", "Home")">Home</a></li>
                            <li class="breadcrumb-item"><a href="@Url.Action("Index", "Certificate")">Certificates</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Certificate Details</li>
                        </ol>
                    </nav>
                    <div class="action-buttons">
                        <button class="btn btn-outline-primary me-2" onclick="window.print()">
                            <i class="fas fa-print me-1"></i>
                            Print Certificate
                        </button>
                        <a href="@Url.Action("Index", "Certificate")" class="btn btn-secondary">
                            <i class="fas fa-arrow-left me-1"></i>
                            Back to Certificates
                        </a>
                    </div>
                </div>
            }

            <!-- Certificate Container -->
            <div class="certificate-container">
                <div class="certificate-content">
                    <!-- Certificate Header -->
                    <div class="certificate-header">
                        <div class="certificate-logo">
                            <img src="~/img/logo/logowithoutbackground.png" alt="BrainStormEra Logo" class="logo">
                        </div>
                        <div class="certificate-title">
                            <h1>Certificate of Completion</h1>
                            <div class="certificate-subtitle">This certifies that</div>
                        </div>
                    </div>

                    <!-- Learner Information -->
                    <div class="learner-section">
                        <div class="learner-name">@Model.LearnerName</div>
                        <div class="completion-text">has successfully completed the course</div>
                    </div>

                    <!-- Course Information -->
                    <div class="course-section">
                        <div class="course-name">@Model.CourseName</div>
                        <div class="course-meta">
                            <div class="meta-row">
                                <span class="meta-label">Instructor:</span>
                                <span class="meta-value">@Model.InstructorName</span>
                            </div>
                            <div class="meta-row">
                                <span class="meta-label">Completion Date:</span>
                                <span class="meta-value">@Model.FormattedCompletedDate</span>
                            </div>
                            <div class="meta-row">
                                <span class="meta-label">Duration:</span>
                                <span class="meta-value">@Model.CompletionDurationDays day@(Model.CompletionDurationDays != 1 ? "s" : "")</span>
                            </div>
                            <div class="meta-row">
                                <span class="meta-label">Final Score:</span>
                                <span class="meta-value">@Model.ProgressPercentage%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Certificate Footer -->
                    <div class="certificate-footer">
                        <div class="signature-section">
                            <div class="signature-line">
                                <div class="signature-placeholder"></div>
                                <div class="signature-label">Authorized Signature</div>
                            </div>
                        </div>

                        <div class="certificate-seal">
                            <div class="seal-circle">
                                <i class="fas fa-certificate"></i>
                                <div class="seal-text">CERTIFIED</div>
                            </div>
                        </div>

                        <div class="certificate-info">
                            <div class="certificate-code">
                                Certificate ID: @Model.CertificateCode
                            </div>
                            <div class="issue-date">
                                Issued on @Model.FormattedCompletedDate
                            </div>
                            <div class="verification-note">
                                This certificate can be verified at brainstormera.com/verify
                            </div>
                        </div>
                    </div>

                    <!-- Decorative Elements -->
                    <div class="certificate-border"></div>
                    <div class="certificate-decoration">
                        <div class="decoration-corner decoration-top-left"></div>
                        <div class="decoration-corner decoration-top-right"></div>
                        <div class="decoration-corner decoration-bottom-left"></div>
                        <div class="decoration-corner decoration-bottom-right"></div>
                    </div>
                </div>
            </div>

            @if (!printMode)
            {
                <!-- Additional Information -->
                <div class="additional-info no-print">
                    <div class="row">
                        <div class="col-md-8">
                            <h4>Course Details</h4>
                            <p class="text-muted">@Model.CourseDescription</p>

                            <h5>Learning Journey</h5>
                            <div class="journey-stats">
                                <div class="stat-item">
                                    <i class="fas fa-calendar-plus text-primary"></i>
                                    <div>
                                        <strong>Started:</strong>
                                        <span>@Model.FormattedEnrollmentDate</span>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-calendar-check text-success"></i>
                                    <div>
                                        <strong>Completed:</strong>
                                        <span>@Model.FormattedCompletedDate</span>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-trophy text-warning"></i>
                                    <div>
                                        <strong>Achievement:</strong>
                                        <span>@Model.ProgressPercentage% Course Completion</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="share-section">
                                <h5>Share Your Achievement</h5>
                                <div class="share-buttons">
                                    <button class="btn btn-outline-primary btn-sm" onclick="shareOnLinkedIn()">
                                        <i class="fab fa-linkedin me-1"></i>
                                        LinkedIn
                                    </button>
                                    <button class="btn btn-outline-info btn-sm" onclick="shareOnTwitter()">
                                        <i class="fab fa-twitter me-1"></i>
                                        Twitter
                                    </button>
                                    <button class="btn btn-outline-success btn-sm" onclick="copyUrl()">
                                        <i class="fas fa-link me-1"></i>
                                        Copy Link
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>

    @if (!printMode)
    {
        <!-- Footer -->
        @await Html.PartialAsync("~/Views/Shared/Footer/_Footer.cshtml")
    }

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    @if (!printMode)
    {
        <script src="~/js/shared/toast-notifications.js"></script>
        <script src="~/js/components/loader.js"></script>
        <script src="~/js/pages/certificate-details.js"></script>
    }
    
    @if (printMode)
    {
        <script>
            window.addEventListener('load', function() {
                setTimeout(function() {
                    window.print();
                }, 1000);
            });
        </script>
    }
    
    <!-- Pass data to JavaScript -->
    <script>
        window.certificateData = {
            courseName: '@Html.Raw(Html.Encode(Model.CourseName))',
            printMode: @Html.Raw(printMode ? "true" : "false")
        };
    </script>

</body>
</html>
